<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Services on Light OAuth2 - OAuth2 Serivces based on Light Java</title>
    <link>https://networknt.github.io/light-oauth2/services/index.xml</link>
    <description>Recent content in Services on Light OAuth2 - OAuth2 Serivces based on Light Java</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Released under the MIT license</copyright>
    <lastBuildDate>Sun, 01 Jan 2017 09:37:52 -0500</lastBuildDate>
    <atom:link href="https://networknt.github.io/light-oauth2/services/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Services</title>
      <link>https://networknt.github.io/light-oauth2/services/</link>
      <pubDate>Sun, 01 Jan 2017 09:37:52 -0500</pubDate>
      
      <guid>https://networknt.github.io/light-oauth2/services/</guid>
      <description>&lt;p&gt;There are three editions of OAuth2 servers available and each edition has different set of services and endpoints. For
Development edition, there is only one service to serve both code and token endpoints. And for Enterprise edition, there are six services with numeric endpoints. Provider edition is still in planning phase but it will have more features than Enterprise edition.&lt;/p&gt;

&lt;p&gt;The following links documented services and endpoints served by each service for three editions.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;development/&#34;&gt;Development edition&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;enterprise/&#34;&gt;Enterprise edition&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;provider/&#34;&gt;Provider edition&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Provider Edition</title>
      <link>https://networknt.github.io/light-oauth2/services/provider/</link>
      <pubDate>Sun, 01 Jan 2017 09:37:43 -0500</pubDate>
      
      <guid>https://networknt.github.io/light-oauth2/services/provider/</guid>
      <description>&lt;p&gt;To be implemented.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Enterprise Edition</title>
      <link>https://networknt.github.io/light-oauth2/services/enterprise/</link>
      <pubDate>Sun, 01 Jan 2017 09:37:32 -0500</pubDate>
      
      <guid>https://networknt.github.io/light-oauth2/services/enterprise/</guid>
      <description>

&lt;p&gt;There are six standard services that cover standard OAuth2 grant flows and extended features like
service on-boarding, client on-boarding, user management and public key certificate distribution.&lt;/p&gt;

&lt;p&gt;This document only describe the features and processes of each service. Please refer to &lt;a href=&#34;https://networknt.github.io/light-oauth2/tutorial/enterprise/&#34;&gt;tutorial&lt;/a&gt;
on how to access these services.&lt;/p&gt;

&lt;h1 id=&#34;code&#34;&gt;Code&lt;/h1&gt;

&lt;p&gt;This is a service that support authorization code grant type. The authorization
code grant type is used to obtain both access tokens and refresh tokens and is
optimized for confidential clients. Since this is a redirection-based flow, the
client must be capable of interacting with the resource owner&amp;rsquo;s user-agent
(typically a web browser) and capable of receiving incoming requests (via
redirection) from the authorization server.&lt;/p&gt;

&lt;p&gt;The service accepts user credentials and redirects back authorization code with
redirect URI defined in the client registration or overwritten it by passing in
a redirect URI in the request.&lt;/p&gt;

&lt;h2 id=&#34;request&#34;&gt;Request&lt;/h2&gt;

&lt;p&gt;The client constructs the request URI by adding the following parameters to the
query component of the authorization endpoint URI using the
&amp;ldquo;application/x-www-form-urlencoded&amp;rdquo; format.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;response_type&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED. Value MUST be set to &amp;ldquo;code&amp;rdquo;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;client_id&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED. The client identifier.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;redirect_uri
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;OPTIONAL. Redirect URI.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;scope&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;OPTIONAL. The scope of the access request.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;state
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;RECOMMENDED. An opaque value used by the client to maintain state between the
request and callback. The authorization server includes this value when redirecting
the user-agent back to the client. The parameter SHOULD be used for preventing
cross-site request forgery.&lt;/p&gt;

&lt;h2 id=&#34;authorization-response&#34;&gt;Authorization Response&lt;/h2&gt;

&lt;p&gt;If the resource owner grants the access request, the authorization server issues
an authorization code and delivers it to the client by adding the following
parameters to the query component of the redirection URI using the
&amp;ldquo;application/x-www-form-urlencoded&amp;rdquo; format.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;code
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED. The authorization code generated by the authorization server.  The
authorization code MUST expire shortly after it is issued to mitigate the risk
of leaks. A maximum authorization code lifetime of 10 minutes is RECOMMENDED.&lt;br /&gt;
The client MUST NOT use the authorization code more than once. If an
authorization code is used more than once, the authorization server MUST deny
the request and SHOULD revoke (when possible) all tokens previously issued based
on that authorization code. The authorization code is bound to the client
identifier and redirection URI.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;state
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED if the &amp;ldquo;state&amp;rdquo; parameter was present in the client authorization
request. The exact value received from the client.&lt;/p&gt;

&lt;h2 id=&#34;error-response&#34;&gt;Error Response&lt;/h2&gt;

&lt;p&gt;If the request fails due to a missing, invalid, or mismatching redirection URI,
or if the client identifier is missing or invalid, the authorization server
SHOULD inform the resource owner of the error and MUST NOT automatically redirect
the user-agent to the invalid redirection URI.&lt;/p&gt;

&lt;p&gt;If the resource owner denies the access request or if the request fails for
reasons other than a missing or invalid redirection URI, the authorization server
informs the client by adding the following parameters to the query component of
the redirection URI using the &amp;ldquo;application/x-www-form-urlencoded&amp;rdquo; format.&lt;/p&gt;

&lt;h3 id=&#34;error&#34;&gt;error&lt;/h3&gt;

&lt;p&gt;REQUIRED. A single ASCII [USASCII] error code from the following:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;invalid_request&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The request is missing a required parameter, includes an invalid parameter value,
includes a parameter more than once, or is otherwise malformed.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;unauthorized_client&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The client is not authorized to request an authorization code using this method.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;access_denied
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The resource owner or authorization server denied the request.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;unsupported_response_type&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The authorization server does not support obtaining an authorization code using
this method.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;invalid_scope&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The requested scope is invalid, unknown, or malformed.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;server_error&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The authorization server encountered an unexpected condition that prevented it
from fulfilling the request.&lt;/p&gt;

&lt;p&gt;(This error code is needed because a 500 Internal Server Error HTTP status code
cannot be returned to the client via an HTTP redirect.)&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;temporarily_unavailable&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The authorization server is currently unable to handle the request due to a
temporary overloading or maintenance of the server.  (This error code is needed
because a 503 Service Unavailable HTTP status code cannot be returned to the client
via an HTTP redirect.)&lt;/p&gt;

&lt;p&gt;Values for the &amp;ldquo;error&amp;rdquo; parameter MUST NOT include characters outside the set
%x20-21 / %x23-5B / %x5D-7E.&lt;/p&gt;

&lt;h3 id=&#34;error-description&#34;&gt;error_description&lt;/h3&gt;

&lt;p&gt;OPTIONAL. Human-readable ASCII [USASCII] text providing additional information,
used to assist the client developer in understanding the error that occurred.&lt;/p&gt;

&lt;p&gt;Values for the &amp;ldquo;error_description&amp;rdquo; parameter MUST NOT include characters outside
the set %x20-21 / %x23-5B / %x5D-7E.&lt;/p&gt;

&lt;h3 id=&#34;error-uri&#34;&gt;error_uri&lt;/h3&gt;

&lt;p&gt;OPTIONAL. A URI identifying a human-readable web page with information about the
error, used to provide the client developer with additional information about the
error.&lt;/p&gt;

&lt;p&gt;Values for the &amp;ldquo;error_uri&amp;rdquo; parameter MUST conform to the URI-reference syntax and
thus MUST NOT include characters outside the set %x21 / %x23-5B / %x5D-7E.&lt;/p&gt;

&lt;h3 id=&#34;state&#34;&gt;state&lt;/h3&gt;

&lt;p&gt;REQUIRED if a &amp;ldquo;state&amp;rdquo; parameter was present in the client authorization request.&lt;br /&gt;
The exact value received from the client.&lt;/p&gt;

&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;

&lt;p&gt;There are two endpoints and the service default listening port is 6881.&lt;/p&gt;

&lt;p&gt;Here is the specification:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;swagger: &#39;2.0&#39;

info:
  version: &amp;quot;1.0.0&amp;quot;
  title: OAuth2 Service Authorization Code
  description: OAuth2 Service that logs in user and provide authorization code. 
  contact:
    email: stevehu@gmail.com
  license:
    name: &amp;quot;Apache 2.0&amp;quot;
    url: &amp;quot;http://www.apache.org/licenses/LICENSE-2.0.html&amp;quot;
host: oauth2.networknt.com
schemes:
  - http
  - https

consumes:
  - application/json
produces:
  - application/json

paths:
  /oauth2/code:
    get:
      description: Return 302 redirect with authorization code
      operationId: getAuthCode
      parameters:
      - name: &amp;quot;Authorization&amp;quot;
        description: &amp;quot;encoded username:password mandatory if Basic Authentication is used&amp;quot;
        in: &amp;quot;header&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;response_type&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;The response type for authorization code&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
        enum:
        - &amp;quot;code&amp;quot;
      - name: &amp;quot;client_id&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;The client id for authorization code&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;redirect_uri&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;The redirect uri for authorization code&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;username&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;The user name for authorization code&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;password&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;The password for authorization code in clear text&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;state&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;to prevent cross-site request forgery&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;scope&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;scope of the request&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      responses:
        302:
          description: &amp;quot;Successful Operation&amp;quot;

    post:
      description: Return 302 redirect with authorization code
      operationId: postAuthCode
      consumes:
      - &amp;quot;application/x-www-form-urlencoded&amp;quot;
      produces:
      - &amp;quot;application/json&amp;quot;
      parameters:
      - name: &amp;quot;j_username&amp;quot;
        in: &amp;quot;formData&amp;quot;
        description: &amp;quot;User name&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;j_password&amp;quot;
        in: &amp;quot;formData&amp;quot;
        description: &amp;quot;Password&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;response_type&amp;quot;
        in: &amp;quot;formData&amp;quot;
        description: &amp;quot;Response type&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
        enum: 
        - &amp;quot;code&amp;quot;
      - name: &amp;quot;client_id&amp;quot;
        in: &amp;quot;formData&amp;quot;
        description: &amp;quot;Client Id&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;redirect_uri&amp;quot;
        in: &amp;quot;formData&amp;quot;
        description: &amp;quot;Redirect Uri&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;state&amp;quot;
        in: &amp;quot;formData&amp;quot;
        description: &amp;quot;to prevent cross-site request forgery&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      - name: &amp;quot;scope&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;scope of the request&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      responses:
        302:
          description: &amp;quot;Successful Operation&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;oauth2-code-get&#34;&gt;/oauth2/code@get&lt;/h3&gt;

&lt;p&gt;The get endpoint is the most used as it is very simple and supported by all browsers
without any customization. When request is received by the service, the following
validations or processes are done before issuing a authorization code redirect.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Make sure that user credentials are passed in. Otherwise, it will redirect the
browser to display popup window to collect userId and password. The username and
password will be passed in as Basic Authorization header. The passed in userId
and password will be matched with cached password(which is hashed and salted). If
userId and password combination is not valid, then a brand new popup window will
be shown. Depending on browsers, an error message will be shown up after several
times of retries.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;If password is incorrect, then the following error will return.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12016&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 401,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12016&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;INCORRECT_PASSWORD&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Incorrect password.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Make sure that response_type and client_id are passed in as parameters. If not,
the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11000&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11000&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_REQUEST_PARAMETER_QUERY_MISSING&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Query parameter &#39;%s&#39; is required on path &#39;%s&#39; but not found in request.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If response_type doesn&amp;rsquo;t equal &amp;ldquo;code&amp;rdquo; then the following error will return&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11002&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11002&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_REQUEST_PARAMETER_ENUM_INVALID&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Value &#39;%s&#39; for parameter &#39;%s&#39; is not allowed. Allowed values are &amp;lt;%s&amp;gt;.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Make sure client_id passed in is valid again in memory client cache. If not,
then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12014&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12014&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;CLIENT_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Client %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;As you can see from the specification, there is an optional parameter called
redirect_uri. If this parameter is passed in, it will be used to redirect the
authorization code. Otherwise, the default redirect_uri from client_id will be
used. This is retrieved from in memory client cache. The url is populated when
client is registered during on-boarding process.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;oauth2-code-post&#34;&gt;/oauth2/code@post&lt;/h3&gt;

&lt;p&gt;To be completed later&lt;/p&gt;

&lt;h1 id=&#34;token&#34;&gt;Token&lt;/h1&gt;

&lt;p&gt;This is a post endpoint to get JSON web tokens. Currently, it support three different
grant types: authorization_code, client_credentials and password.&lt;/p&gt;

&lt;h2 id=&#34;authorization-code-grant-type&#34;&gt;Authorization Code Grant Type&lt;/h2&gt;

&lt;h3 id=&#34;request-1&#34;&gt;Request&lt;/h3&gt;

&lt;p&gt;The client makes a request to the token endpoint by sending the following
parameters using the &amp;ldquo;application/x-www-form-urlencoded&amp;rdquo; format.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;grant_type
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED. Value MUST be set to &amp;ldquo;authorization_code&amp;rdquo;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;code
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED.  The authorization code received from the authorization server.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;redirect_uri
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED, if the &amp;ldquo;redirect_uri&amp;rdquo; parameter was included in the authorization
request, and their values MUST be identical.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;client_id:client_secret
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED, as BASIC authorization header with encoded client_id:client_secret
to authenticate with the authorization server.&lt;/p&gt;

&lt;h3 id=&#34;response&#34;&gt;Response&lt;/h3&gt;

&lt;p&gt;If the access token request is valid and authorized, the authorization server
issues an access token and a refresh token.  If the request client
authentication failed or is invalid, the authorization server returns an error
response.&lt;/p&gt;

&lt;h2 id=&#34;client-credentials-grant-type&#34;&gt;Client Credentials Grant Type&lt;/h2&gt;

&lt;p&gt;The client can request an access token using only its client credentials
(or other supported means of authentication) when the client is requesting
access to the protected resources under its control, or those of another
resource owner that have been previously arranged with the authorization
server.&lt;/p&gt;

&lt;h3 id=&#34;request-2&#34;&gt;Request&lt;/h3&gt;

&lt;p&gt;The client makes a request to the token endpoint by adding the following
parameters using the &amp;ldquo;application/x-www-form-urlencoded&amp;rdquo; format with a
character encoding of UTF-8 in the HTTP request entity-body:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;grant_type
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED. Value MUST be set to &amp;ldquo;client_credentials&amp;rdquo;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;scope
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;OPTIONAL. The scope of the access request.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;client_id:client_secret
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED, as BASIC authorization header with encoded client_id:client_secret
to authenticate with the authorization server.&lt;/p&gt;

&lt;h3 id=&#34;response-1&#34;&gt;Response&lt;/h3&gt;

&lt;p&gt;If the access token request is valid and authorized, the authorization server
issues an access token. A refresh token SHOULD NOT be included. If the request
failed client authentication or is invalid, the authorization server returns
an error response.&lt;/p&gt;

&lt;h2 id=&#34;resource-owner-password-credentials-grant-type&#34;&gt;Resource Owner Password Credentials Grant Type&lt;/h2&gt;

&lt;p&gt;The resource owner password credentials grant type is suitable in cases where
the resource owner has a trust relationship with the client, such as the device
operating system or a highly privileged application. The authorization server
should take special care when enabling this grant type and only allow it when
other flows are not viable. In this implementation, only client registered as
trusted can use password grant type.&lt;/p&gt;

&lt;p&gt;This grant type is suitable for clients capable of obtaining the resource owner&amp;rsquo;s
credentials (username and password, typically using an interactive form).  It is
also used to migrate existing clients using direct authentication schemes such as
HTTP Basic or Digest authentication to OAuth by converting the stored credentials
to an access token.&lt;/p&gt;

&lt;h3 id=&#34;request-3&#34;&gt;Request&lt;/h3&gt;

&lt;p&gt;The client makes a request to the token endpoint by adding the following
parameters using the &amp;ldquo;application/x-www-form-urlencoded&amp;rdquo; format with a character
encoding of UTF-8 in the HTTP request entity-body:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;grant_type
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED. Value MUST be set to &amp;ldquo;password&amp;rdquo;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;username&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED. The resource owner username.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;password&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED. The resource owner password.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;scope
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;OPTIONAL. The scope of the access request.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;client_id:client_secret
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED, as BASIC authorization header with encoded client_id:client_secret
to authenticate with the authorization server.&lt;/p&gt;

&lt;h3 id=&#34;response-2&#34;&gt;Response&lt;/h3&gt;

&lt;p&gt;If the access token request is valid and authorized, the authorization server
issues an access token and a refresh token. If the request failed client
authentication or is invalid, the authorization server returns an error response.&lt;/p&gt;

&lt;h2 id=&#34;refresh-token-grant-type&#34;&gt;Refresh Token Grant Type&lt;/h2&gt;

&lt;p&gt;If the authorization server issued a refresh token to the client, the client
makes a refresh request to the token endpoint by adding the following parameters
using the &amp;ldquo;application/x-www-form-urlencoded&amp;rdquo; format with a character encoding of
UTF-8 in the HTTP request entity-body.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;grant_type&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED.  Value MUST be set to &amp;ldquo;refresh_token&amp;rdquo;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;refresh_token&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;REQUIRED.  The refresh token issued to the client.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;scope&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;OPTIONAL.  The scope of the access request. The requested scope MUST NOT include
any scope not originally granted by the resource owner, and if omitted is treated
as equal to the scope originally granted by the resource owner.&lt;/p&gt;

&lt;p&gt;Because refresh tokens are typically long-lasting credentials used to request
additional access tokens, the refresh token is bound to the client to which it was
issued. If the client type is confidential or the client was issued client credentials
(or assigned other authentication requirements), the client MUST authenticate with the
authorization server.&lt;/p&gt;

&lt;p&gt;The authorization server MUST:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;require client authentication for confidential clients or for any client that was
issued client credentials (or with other authentication requirements),&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;authenticate the client if client authentication is included and ensure that the
refresh token was issued to the authenticated client, and&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;validate the refresh token.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If valid and authorized, the authorization server issues an access token. If the
request failed verification or is invalid, the authorization server returns an error
response.&lt;/p&gt;

&lt;p&gt;The authorization server issues a new refresh token and the client MUST discard the
old refresh token and replace it with the new refresh token. The authorization server
revoke the old refresh token after issuing a new refresh token to the client. The new
refresh token scope MUST be identical to that of the refresh token included by the
client in the request.&lt;/p&gt;

&lt;h2 id=&#34;implementation-1&#34;&gt;Implementation&lt;/h2&gt;

&lt;p&gt;There is only one post endpoint for this service and the default port is 6882.&lt;/p&gt;

&lt;p&gt;Here is the specification.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;swagger: &#39;2.0&#39;

info:
  version: &amp;quot;1.0.0&amp;quot;
  title: OAuth2 Service Token Service
  description: OAuth2 Service that issues access tokens. 
  contact:
    email: stevehu@gmail.com
  license:
    name: &amp;quot;Apache 2.0&amp;quot;
    url: &amp;quot;http://www.apache.org/licenses/LICENSE-2.0.html&amp;quot;
host: oauth2.networknt.com
schemes:
  - http
  - https

consumes:
  - application/x-www-form-urlencoded   
produces:
  - application/json

paths:
  /oauth2/token:
    post:
      description: JSON object that contains access token
      operationId: postToken
      parameters:
      - name: authorization
        description: &amp;quot;encoded client_id and client_secret pair&amp;quot;
        in: header
        type: string
        required: true      
      - name: grant_type
        type: string
        enum: 
        - authorization_code
        - client_credentials
        - password
        - refresh_token
        required: true
        in: formData
      - name: code
        description: &amp;quot;used in authorization_code to specify the code&amp;quot; 
        type: string
        in: formData
      - name: username
        description: &amp;quot;mandatory in password grant type&amp;quot;
        type: string
        in: formData
      - name: password
        description: &amp;quot;mandatory in password grant type&amp;quot;
        type: string
        in: formData
      - name: scope
        description: &amp;quot;used by all flows to specify scope in the access token&amp;quot;
        type: string
        in: formData
      - name: redirect_uri
        description: &amp;quot;used in authorization code if code endpoint with rediret_uri&amp;quot;
        type: string
        in: formData
      - name: refresh_token
        description: &amp;quot;refresh token used to get another access token&amp;quot;
        type: string
        in: formData
      responses:
        200:
          description: &amp;quot;Successful Operation&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;oauth2-token&#34;&gt;/oauth2/token&lt;/h3&gt;

&lt;p&gt;When a post request is received, the following validations and processes will be performed.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;The handler expects a x-www-form-urlencoded form and if it doesn&amp;rsquo;t exist, the following
error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12000&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12000&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;UNABLE_TO_PARSE_FORM_DATA&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Unable to parse x-www-form-urlencoded form data.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;The parameter grant type should only allowed client_credentials and authorization_code. If
other grant_type is passed in, the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12001&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12001&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;UNSUPPORTED_GRANT_TYPE&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Unsupported grant type %s. Only authorization_code and client_credentials are supported.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;When this endpoint is called, the client_id and client_secret must be base64 encoded and put
into Authorization header. If there is no Authorization header available in the request, the
following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11017&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11017&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_REQUEST_PARAMETER_HEADER_MISSING&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Header parameter &#39;%s&#39; is required on path &#39;%s&#39; but not found in request.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;When validating client_id and client_secret, the first thing is to check the client_id in
the client cache in memory. If client_id doesn&amp;rsquo;t exist, the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12014&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12014&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;CLIENT_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Client %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;The encoded client_id:client_secret combination will be decoded and then client secret will
be checked with hashed and salted in memory client secret to make sure it is correct. If the
client secret is not correct, the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12007&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 401,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12007&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;UNAUTHORIZED_CLIENT&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Unauthorized client with wrong client secret.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If the basic client_id:client_secret cannot be decoded and parsed correctly, the following
error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12004&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 401,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12004&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;INVALID_BASIC_CREDENTIALS&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Invalid Basic credentials %s.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If there is no Basic authorization header passed in, i.e. a bearer token is passed in, the
following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12003&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 401,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12003&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;INVALID_AUTHORIZATION_HEADER&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Invalid authorization header %s. Basic authentication with credentials is required.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If all validation is passed, a JWT token will be generated and returned in a JSON object.&lt;/p&gt;

&lt;h1 id=&#34;service&#34;&gt;Service&lt;/h1&gt;

&lt;p&gt;Every micro service or API needs to register itself to OAuth2 server in order to control who
can access it. During the registration/on-boarding, a list of scopes defined in the OpenAPI
specification should be populated as well. This list of scopes will be used for client to
register scopes in order to access this particular service or API.&lt;/p&gt;

&lt;p&gt;This service has several endpoints and listening to port 6883.&lt;/p&gt;

&lt;p&gt;Here is the specification.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;swagger: &#39;2.0&#39;

info:
  version: &amp;quot;1.0.0&amp;quot;
  title: OAuth2 Service Registration
  description: OAuth2 Service Registration microservices endpoints. 
  contact:
    email: stevehu@gmail.com
  license:
    name: &amp;quot;Apache 2.0&amp;quot;
    url: &amp;quot;http://www.apache.org/licenses/LICENSE-2.0.html&amp;quot;
host: oauth2.networknt.com
schemes:
  - http
  - https

consumes:
  - application/json
produces:
  - application/json

paths:
  /oauth2/service:
    post:
      description: Return a service object
      operationId: createService
      parameters:
      - in: &amp;quot;body&amp;quot;
        name: &amp;quot;body&amp;quot;
        description: &amp;quot;Service object that needs to be added&amp;quot;
        required: true
        schema:
          $ref: &amp;quot;#/definitions/Service&amp;quot;      
      responses:
        200:
          description: Successful response
          schema:
            $ref: &amp;quot;#/definitions/Service&amp;quot;          
      security:
      - service_auth:
        - &amp;quot;oauth.service.w&amp;quot;
    put:
      description: Return the updated service
      operationId: updateService
      parameters:
      - in: &amp;quot;body&amp;quot;
        name: &amp;quot;body&amp;quot;
        description: &amp;quot;Service object that needs to be added&amp;quot;
        required: true
        schema:
          $ref: &amp;quot;#/definitions/Service&amp;quot;      
      responses:
        200:
          description: Successful response
          schema:
            $ref: &amp;quot;#/definitions/Service&amp;quot;          
      security:
      - service_auth:
        - &amp;quot;oauth.service.w&amp;quot;
    get:
      description: Return all services
      operationId: getAllService
      parameters:
      - name: &amp;quot;page&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Page number&amp;quot;
        required: true
        type: &amp;quot;integer&amp;quot;
        format: &amp;quot;int32&amp;quot;
      - name: &amp;quot;pageSize&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Pag size&amp;quot;
        required: false
        type: &amp;quot;integer&amp;quot;
        format: &amp;quot;int32&amp;quot;
      - name: &amp;quot;serviceId&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Partial serviceId for filter&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      responses:
        200:
          description: &amp;quot;successful operation&amp;quot;
          schema:
            type: &amp;quot;array&amp;quot;
            items:
              $ref: &amp;quot;#/definitions/Service&amp;quot;
      security:
      - service_auth:
        - &amp;quot;oauth.service.r&amp;quot;
          
  /oauth2/service/{serviceId}:
    delete:
      description: Delete a service by Id
      operationId: deleteService
      parameters:
      - name: &amp;quot;serviceId&amp;quot;
        in: &amp;quot;path&amp;quot;
        description: &amp;quot;Service Id&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      responses:
        400:
          description: &amp;quot;Invalid serviceId supplied&amp;quot;
        404:
          description: &amp;quot;Service not found&amp;quot;
      security:
        - service_auth:
          - oauth.service.w
    get:
      description: Get a service by Id
      operationId: getService
      parameters:
      - name: &amp;quot;serviceId&amp;quot;
        in: &amp;quot;path&amp;quot;
        description: &amp;quot;Service Id&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      responses:
        200: 
          description: Successful response
          schema:
            $ref: &amp;quot;#/definitions/Service&amp;quot;          
        400:
          description: &amp;quot;Invalid serviceId supplied&amp;quot;
        404:
          description: &amp;quot;Service not found&amp;quot;
      security:
        - service_auth:
          - oauth.service.r
          - oauth.service.w

securityDefinitions:
  service_auth:
    type: &amp;quot;oauth2&amp;quot;
    authorizationUrl: &amp;quot;http://localhost:8888/oauth2/code&amp;quot;
    flow: &amp;quot;implicit&amp;quot;
    scopes:
      oauth.service.w: &amp;quot;write oauth service&amp;quot;
      oauth.service.r: &amp;quot;read oauth service&amp;quot;
definitions:
  Service:
    type: &amp;quot;object&amp;quot;
    required:
    - &amp;quot;serviceId&amp;quot;
    - &amp;quot;serviceName&amp;quot;
    - &amp;quot;serviceType&amp;quot;
    - &amp;quot;scope&amp;quot;
    properties:
      serviceId:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;a unique service id&amp;quot;
      serviceType:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;service type&amp;quot;
        enum:
        - &amp;quot;ms&amp;quot;
        - &amp;quot;api&amp;quot;
      serviceName:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;service name&amp;quot;
      serviceDesc:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;service description&amp;quot;
      ownerId:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;service owner userId&amp;quot;
      scope:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;service scopes separated by space&amp;quot;
      createDt:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;date-time&amp;quot;
        description: &amp;quot;create date time&amp;quot;
      updateDt:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;date-time&amp;quot;
        description: &amp;quot;update date time&amp;quot;
        

&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-service-get&#34;&gt;/oauth2/service@get&lt;/h2&gt;

&lt;p&gt;This endpoint gets all the services from service with filter and sorted on
serviceId. A page query parameter is mandatory and pageSize and serviceId filter
are optional.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;page&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Page number which must be specified. It starts with 1 and an empty list will
be returned if the page is greater than the last page.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;pageSize&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Default pageSize is 10 and you can overwrite it with another number. Please don&amp;rsquo;t
use a big number due to performance reason.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;serviceId&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is the only filter available and it supports filter by start with a few characters.
For example, &amp;ldquo;serviceId=abc&amp;rdquo; means any serviceId starts with &amp;ldquo;abc&amp;rdquo;. The result is also
sorted by serviceId in the pagination.&lt;/p&gt;

&lt;p&gt;The following validation will be performed in the service.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If page is missing from the query parameter, an error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11000&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11000&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_REQUEST_PARAMETER_QUERY_MISSING&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Query parameter &#39;%s&#39; is required on path &#39;%s&#39; but not found in request.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-service-post&#34;&gt;/oauth2/service@post&lt;/h2&gt;

&lt;p&gt;This endpoint is used to create a new service. The following validation will be performed
before a new service is created.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If serviceId exists in the cache, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12018&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12018&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;SERVICE_ID_EXISTS&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Service id %s exists.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If ownerId doesn&amp;rsquo;t exist in user cache, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12013&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12013&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;USER_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;User %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-service-put&#34;&gt;/oauth2/service@put&lt;/h2&gt;

&lt;p&gt;This is the endpoint to update existing service. Before service is updated, the
following validation will be performed.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If serviceId cannot be found in the service cache, then the following error will be
returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12015&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12015&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;SERVICE_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Service %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If ownerId doesn&amp;rsquo;t exist in user cache, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12013&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12013&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;USER_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;User %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-service-serviceid-delete&#34;&gt;/oauth2/service/{serviceId}@delete&lt;/h2&gt;

&lt;p&gt;This endpoint is used to delete existing service. Before the service is deleted,
the following validations will be performed.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If serviceId cannot be found in the service cache, then the following error will be
returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12015&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12015&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;SERVICE_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Service %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-service-serviceid-get&#34;&gt;/oauth2/service/{serviceId}@get&lt;/h2&gt;

&lt;p&gt;This endpoint is used to get a particular service by serviceId. Before the service is
returned, the following validation will be performed.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If serviceId cannot be found in the service cache, then the following error will be
returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12015&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12015&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;SERVICE_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Service %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;client&#34;&gt;Client&lt;/h1&gt;

&lt;p&gt;Before initiating the protocol, the client registers with the authorization server. The
means through which the client registers with the authorization server are not defined
in OAuth 2.0 specification.&lt;/p&gt;

&lt;p&gt;As an extension, we have implemented client registration/on-boarding as a micro service
that exposes several endpoints.&lt;/p&gt;

&lt;p&gt;Before digging into the details of implementation, let&amp;rsquo;s clarify some concepts about
client.&lt;/p&gt;

&lt;h2 id=&#34;client-type&#34;&gt;Client Type&lt;/h2&gt;

&lt;p&gt;OAuth defines two client types, based on their ability to authenticate securely with
the authorization server (i.e., ability to maintain the confidentiality of their
client credentials):&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;confidential&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Clients capable of maintaining the confidentiality of their credentials (e.g., client
implemented on a secure server with restricted access to the client credentials), or
capable of secure client authentication using other means.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;public&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Clients incapable of maintaining the confidentiality of their credentials (e.g.,
clients executing on the device used by the resource owner, such as an installed
native application or a web browser-based application), and incapable of secure
client authentication via any other means.&lt;/p&gt;

&lt;p&gt;Above are standard client types defined in the specification and we have added
another one to control which client can issue resource owner password credentials
grant request.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;trusted&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These clients are marked as trusted and they are the only clients that can issue
resource owner password credentials grant type. For API management team, please
make sure that trusted client is also confidential and the client and resource
must be deployed and managed by the same organization as this flow is not as
secure as authorization code and client credentials flows.&lt;/p&gt;

&lt;p&gt;The client type designation is based on the authorization server&amp;rsquo;s definition of
secure authentication and its acceptable exposure levels of client credentials.&lt;br /&gt;
The authorization server does not make assumptions about the client type.&lt;/p&gt;

&lt;p&gt;A client may be implemented as a distributed set of components or services, each
with a different client type and security context (e.g., a distributed client with
both a confidential server-based component and a public browser-based component).&lt;br /&gt;
In this case, the client should register each component or service as a separate
client.&lt;/p&gt;

&lt;p&gt;In a microservices architecture, a service might call other services to fulfill
its request, in this case, it should register itself as a service and a client.
That means the owner needs to follow both service on-boarding and client on-boarding
processes.&lt;/p&gt;

&lt;h2 id=&#34;client-profile&#34;&gt;Client Profile&lt;/h2&gt;

&lt;p&gt;This specification has been designed around the following client profiles:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;web application (web server)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;A web application is a confidential client running on a web server. Resource owners
access the client via an HTML user interface rendered in a user-agent on the device
used by the resource owner. The client credentials as well as any access token issued
to the client are stored on the web server and are not exposed to or accessible by
the resource owner.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;user-agent-based application (browser)
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;A user-agent-based application is a public client in which the client code is
downloaded from a web server and executes within a user-agent (e.g., web browser) on
the device used by the resource owner. Protocol data and credentials are easily
accessible (and often visible) to the resource owner. Since such applications
reside within the user-agent, they can make seamless use of the user-agent
capabilities when requesting authorization.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;native application (mobile)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;A native application is a public client installed and executed on the device used by
the resource owner. Protocol data and credentials are accessible to the resource owner.&lt;br /&gt;
It is assumed that any client authentication credentials included in the application can
be extracted. On the other hand, dynamically issued credentials such as access tokens or
refresh tokens can receive an acceptable level of protection. At a minimum, these
credentials are protected from hostile servers with which the application may interact.&lt;br /&gt;
On some platforms, these credentials might be protected from other applications residing
on the same device.&lt;/p&gt;

&lt;p&gt;The specification only mentioned above client profiles and the following two profiles
are added in our OAuth 2.0 implementation.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;batch application (batch)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Batch jobs are very similar with web application but they are managed by enterprise
scheduler and executed in a projected environment. It is considered as confidential
client.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;service (service)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Services are usually protected as resources but in a microservices architecture, a
service can also be a client to call other services or resources. These services
normally running within light-weight containers in a secured environment. And they
are considered as confidential clients.&lt;/p&gt;

&lt;h2 id=&#34;client-identifier&#34;&gt;Client Identifier&lt;/h2&gt;

&lt;p&gt;The authorization server issues the registered client a client identifier - a unique
string representing the registration information provided by the client. The client
identifier is not a secret; it is exposed to the resource owner and MUST NOT be used
alone for client authentication. The client identifier is unique to the authorization
server. In our implementation, it is a UUID generated on the server. Here is an example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;f7d42348-c647-4efb-a52d-4c5787421e72
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;client-secret&#34;&gt;Client Secret&lt;/h2&gt;

&lt;p&gt;Clients in possession of a client secret MAY use the HTTP Basic authentication scheme
as defined in [RFC2617] to authenticate with the authorization server. The client
identifier is encoded using the &amp;ldquo;application/x-www-form-urlencoded&amp;rdquo; encoding algorithm
, and the encoded value is used as the username; the client secret is encoded using
the same algorithm and used as the password. The authorization server supports the HTTP
Basic authentication scheme for authenticating clients that were issued a client secret.&lt;/p&gt;

&lt;p&gt;For example (with extra line breaks for display purposes only):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;     Authorization: Basic czZCaGRSa3F0Mzo3RmpmcDBaQnIxS3REUmJuZlZkbUl3
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;other-authentication-methods&#34;&gt;Other Authentication Methods&lt;/h2&gt;

&lt;p&gt;Currently we don&amp;rsquo;t support other authentication method but we are open to support others
if there are request from our users.&lt;/p&gt;

&lt;h2 id=&#34;unregistered-clients&#34;&gt;Unregistered Clients&lt;/h2&gt;

&lt;p&gt;Due to security reasons, all client must be registered before authenticated on the server.
Unregistered clients are not supported on this implementation.&lt;/p&gt;

&lt;h2 id=&#34;client-micro-service&#34;&gt;Client Micro Service&lt;/h2&gt;

&lt;p&gt;This service has several endpoints and listening to port 6884.&lt;/p&gt;

&lt;p&gt;Here is the specification.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;swagger: &#39;2.0&#39;

info:
  version: &amp;quot;1.0.0&amp;quot;
  title: OAuth2 Client Registration
  description: OAuth2 Client Registration microservices endpoints. 
  contact:
    email: stevehu@gmail.com
  license:
    name: &amp;quot;Apache 2.0&amp;quot;
    url: &amp;quot;http://www.apache.org/licenses/LICENSE-2.0.html&amp;quot;
host: oauth2.networknt.com
schemes:
  - http
  - https

consumes:
  - application/json
produces:
  - application/json

paths:
  /oauth2/client:
    post:
      description: Return a client object
      operationId: createClient
      parameters:
      - in: &amp;quot;body&amp;quot;
        name: &amp;quot;body&amp;quot;
        description: &amp;quot;Client object that needs to be added&amp;quot;
        required: true
        schema:
          $ref: &amp;quot;#/definitions/Client&amp;quot;      
      responses:
        200:
          description: Successful response
          schema:
            $ref: &amp;quot;#/definitions/Client&amp;quot;          
      security:
      - client_auth:
        - &amp;quot;oauth.client.w&amp;quot;
    put:
      description: Return the updated client
      operationId: updateClient
      parameters:
      - in: &amp;quot;body&amp;quot;
        name: &amp;quot;body&amp;quot;
        description: &amp;quot;Client object that needs to be added&amp;quot;
        required: true
        schema:
          $ref: &amp;quot;#/definitions/Client&amp;quot;      
      responses:
        200:
          description: Successful response
          schema:
            $ref: &amp;quot;#/definitions/Client&amp;quot;          
      security:
      - client_auth:
        - &amp;quot;oauth.client.w&amp;quot;
    get:
      description: Return all clients
      operationId: getAllClient
      parameters:
      - name: &amp;quot;page&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Page number&amp;quot;
        required: true
        type: &amp;quot;integer&amp;quot;
        format: &amp;quot;int32&amp;quot;
      - name: &amp;quot;pageSize&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Pag size&amp;quot;
        required: false
        type: &amp;quot;integer&amp;quot;
        format: &amp;quot;int32&amp;quot;
      - name: &amp;quot;clientName&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Partial clientName for filter&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      responses:
        200:
          description: &amp;quot;successful operation&amp;quot;
          schema:
            type: &amp;quot;array&amp;quot;
            items:
              $ref: &amp;quot;#/definitions/Client&amp;quot;
      security:
      - client_auth:
        - &amp;quot;oauth.client.r&amp;quot;
          
  /oauth2/client/{clientId}:
    delete:
      description: Delete a client by Id
      operationId: deleteClient
      parameters:
      - name: &amp;quot;clientId&amp;quot;
        in: &amp;quot;path&amp;quot;
        description: &amp;quot;Client Id&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      responses:
        400:
          description: &amp;quot;Invalid clientId supplied&amp;quot;
        404:
          description: &amp;quot;Client not found&amp;quot;
      security:
        - client_auth:
          - oauth.client.w
    get:
      description: Get a client by Id
      operationId: getClient
      parameters:
      - name: &amp;quot;clientId&amp;quot;
        in: &amp;quot;path&amp;quot;
        description: &amp;quot;Client Id&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      responses:
        200: 
          description: Successful response
          schema:
            $ref: &amp;quot;#/definitions/Client&amp;quot;          
        400:
          description: &amp;quot;Invalid clientId supplied&amp;quot;
        404:
          description: &amp;quot;Client not found&amp;quot;
      security:
        - client_auth:
          - oauth.client.r
          - oauth.client.w

securityDefinitions:
  client_auth:
    type: &amp;quot;oauth2&amp;quot;
    authorizationUrl: &amp;quot;http://localhost:8888/oauth2/code&amp;quot;
    flow: &amp;quot;implicit&amp;quot;
    scopes:
      oauth.client.w: &amp;quot;write oauth client&amp;quot;
      oauth.client.r: &amp;quot;read oauth client&amp;quot;
definitions:
  Client:
    type: &amp;quot;object&amp;quot;
    required:
    - clientType
    - clientProfile
    - clientName
    - clientDesc
    - ownerId
    - scope
    properties:
      clientId:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;a unique client id&amp;quot;
      clientSecret:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;client secret&amp;quot;
      clientType:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;client type&amp;quot;
        enum:
        - confidential
        - public
        - trusted
      clientProfile:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;client profile&amp;quot;
        enum:
        - webserver
        - browser
        - mobile
        - service
        - batch
      clientName:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;client name&amp;quot;
      clientDesc:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;client description&amp;quot;
      ownerId:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;client owner id&amp;quot;
      scope:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;client scope separated by space&amp;quot;
      redirectUri:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;redirect uri&amp;quot;
      createDt:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;date-time&amp;quot;
        description: &amp;quot;create date time&amp;quot;
      updateDt:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;date-time&amp;quot;
        description: &amp;quot;update date time&amp;quot;

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;oauth2-client-clientid-delete&#34;&gt;/oauth2/client/{clientId}@delete&lt;/h3&gt;

&lt;p&gt;This endpoint is used to delete existing client. The following validation will be
performed in the service.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If clientId cannot be found in the in-memory grid, then the following error will
be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12014&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12014&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;CLIENT_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Client %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;oauth2-client-clientid-get&#34;&gt;/oauth2/client/{clientId}@get&lt;/h3&gt;

&lt;p&gt;This endpoint is used to get a particular client with clientId. The following
validation will be performed in the service.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If clientId cannot be found in the in-memory grid, then the following error will
be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12014&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12014&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;CLIENT_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Client %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;oauth2-client-get&#34;&gt;/oauth2/client@get&lt;/h3&gt;

&lt;p&gt;This endpoint gets all the clients from client service with filter and sorted on
clientName. A page query parameter is mandatory and pageSize and clientName filter
are optional.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;page&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Page number which must be specified. It starts with 1 and an empty list will
be returned if the page is greater than the last page.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;pageSize&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Default pageSize is 10 and you can overwrite it with another number. Please don&amp;rsquo;t
use a big number due to performance reason.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;clientName&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is the only filter available and it supports filter by start with a few characters.
For example, &amp;ldquo;clientName=abc&amp;rdquo; means any clientName starts with &amp;ldquo;abc&amp;rdquo;. The result is also
sorted by clientName in the pagination.&lt;/p&gt;

&lt;p&gt;The following validation will be performed in the service.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If page is missing from the query parameter, an error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11000&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11000&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_REQUEST_PARAMETER_QUERY_MISSING&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Query parameter &#39;%s&#39; is required on path &#39;%s&#39; but not found in request.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;oauth2-client-post&#34;&gt;/oauth2/client@post&lt;/h3&gt;

&lt;p&gt;This endpoint is used to create a new client. This usually will be called from light-portal
and the following validations will be performed before a new client is added.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Verify that clientId exist in the cache. The clientId is generated as a UUID so this
cannot be triggered. It is implemented this way just want to be in sync with other
services.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12019&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12019&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;CLIENT_ID_EXISTS&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Client id %s exists.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Verify that ownerId is in user cache in memory. If it doesn&amp;rsquo;t exist, the following
error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12013&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12013&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;USER_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;User %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Make sure the clientType is from a list of valid values. If not, an error message
will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11004&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11004&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_SCHEMA&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Schema Validation Error - %s&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Make sure that clientProfile is from a list of valid values. If not, an error
message will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11004&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11004&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_SCHEMA&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Schema Validation Error - %s&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;oauth2-client-put&#34;&gt;/oauth2/client@put&lt;/h3&gt;

&lt;p&gt;This endpoint is used to update an existing client. This usually will be called from
light-portal and the following validations will be performed before a client is updated.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Verify that clientId exist in the cache. If clientId doesn&amp;rsquo;t existing the cache, an
error message will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12014&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12014&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;CLIENT_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Client %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Verify that ownerId is in user cache in memory. If it doesn&amp;rsquo;t exist, the following
error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12013&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12013&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;USER_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;User %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Make sure the clientType is from a list of valid values. If not, an error message
will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11004&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11004&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_SCHEMA&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Schema Validation Error - %s&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Make sure that clientProfile is from a list of valid values. If not, an error
message will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11004&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11004&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_SCHEMA&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Schema Validation Error - %s&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;user&#34;&gt;User&lt;/h1&gt;

&lt;p&gt;This is a service for user registration and management. The OAuth server supports
integration with other user management system like active directory or LDAP.
However, for most enterprise customers, their customer information normally will
be in database. This service provides a database table for user management and
several endpoints to manage users.&lt;/p&gt;

&lt;p&gt;In OAuth 2.0 specification, user is normally called resource owner.&lt;/p&gt;

&lt;h2 id=&#34;user-type&#34;&gt;User Type&lt;/h2&gt;

&lt;p&gt;Currently there are three user types to support.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;customer&lt;/li&gt;
&lt;li&gt;partner&lt;/li&gt;
&lt;li&gt;employee&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;user-id&#34;&gt;User Id&lt;/h2&gt;

&lt;p&gt;User id must be unique within the system.&lt;/p&gt;

&lt;h2 id=&#34;password&#34;&gt;Password&lt;/h2&gt;

&lt;p&gt;Password is provided when registering and it is hashed and salted in persistence
layer.&lt;/p&gt;

&lt;h2 id=&#34;user-micro-service&#34;&gt;User Micro Service&lt;/h2&gt;

&lt;p&gt;This service has several endpoints and listening to port 6885.&lt;/p&gt;

&lt;p&gt;Here is the specification.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;swagger: &#39;2.0&#39;

info:
  version: &amp;quot;1.0.0&amp;quot;
  title: OAuth2 User Service
  description: OAuth2 User Service microservices endpoints. 
  contact:
    email: stevehu@gmail.com
  license:
    name: &amp;quot;Apache 2.0&amp;quot;
    url: &amp;quot;http://www.apache.org/licenses/LICENSE-2.0.html&amp;quot;
host: oauth2.networknt.com
schemes:
  - http
  - https

consumes:
  - application/json
produces:
  - application/json

paths:
  /oauth2/user:
    get:
      description: Return all users
      operationId: getAllUsers
      parameters:
      - name: &amp;quot;page&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Page number&amp;quot;
        required: true
        type: &amp;quot;integer&amp;quot;
        format: &amp;quot;int32&amp;quot;
      - name: &amp;quot;pageSize&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Pag size&amp;quot;
        required: false
        type: &amp;quot;integer&amp;quot;
        format: &amp;quot;int32&amp;quot;
      - name: &amp;quot;userId&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Partial userId for filter&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      responses:
        200:
          description: &amp;quot;successful operation&amp;quot;
          schema:
            type: &amp;quot;array&amp;quot;
            items:
              $ref: &amp;quot;#/definitions/User&amp;quot;
      security:
      - user_auth:
        - &amp;quot;oauth.user.r&amp;quot;
    post:
      description: Return a user object
      operationId: createUser
      parameters:
      - in: &amp;quot;body&amp;quot;
        name: &amp;quot;body&amp;quot;
        description: &amp;quot;User object that needs to be added&amp;quot;
        required: true
        schema:
          $ref: &amp;quot;#/definitions/User&amp;quot;      
      responses:
        200:
          description: Successful response
      security:
      - user_auth:
        - &amp;quot;oauth.user.w&amp;quot;
    put:
      description: Return the updated user
      operationId: updateUser
      parameters:
      - in: &amp;quot;body&amp;quot;
        name: &amp;quot;body&amp;quot;
        description: &amp;quot;User object that needs to be added&amp;quot;
        required: true
        schema:
          $ref: &amp;quot;#/definitions/User&amp;quot;      
      responses:
        200:
          description: Successful response
      security:
      - user_auth:
        - &amp;quot;oauth.user.w&amp;quot;
          
  /oauth2/user/{userId}:
    delete:
      description: Delete a user by Id
      operationId: deleteUser
      parameters:
      - name: &amp;quot;userId&amp;quot;
        in: &amp;quot;path&amp;quot;
        description: &amp;quot;User Id&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      responses:
        400:
          description: &amp;quot;Invalid userId supplied&amp;quot;
        404:
          description: &amp;quot;User not found&amp;quot;
      security:
        - user_auth:
          - oauth.user.w
    get:
      description: Get a user by Id
      operationId: getUser
      parameters:
      - name: &amp;quot;userId&amp;quot;
        in: &amp;quot;path&amp;quot;
        description: &amp;quot;User Id&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      responses:
        200: 
          description: Successful response
          schema:
            $ref: &amp;quot;#/definitions/User&amp;quot;          
        400:
          description: &amp;quot;Invalid userId supplied&amp;quot;
        404:
          description: &amp;quot;User not found&amp;quot;
      security:
        - user_auth:
          - oauth.user.r
          - oauth.user.w
  /oauth2/password/{userId}:
    post:
      description: Reset Password
      operationId: resetPassword
      parameters:
      - in: &amp;quot;body&amp;quot;
        name: &amp;quot;body&amp;quot;
        description: &amp;quot;Password object that needs to be added&amp;quot;
        required: true
        schema:
          $ref: &amp;quot;#/definitions/Password&amp;quot;      
      - name: &amp;quot;userId&amp;quot;
        in: &amp;quot;path&amp;quot;
        description: &amp;quot;User Id&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      responses:
        404:
          description: &amp;quot;User not found&amp;quot;
      security:
      - user_auth:
        - &amp;quot;oauth.user.w&amp;quot;
          
securityDefinitions:
  user_auth:
    type: &amp;quot;oauth2&amp;quot;
    authorizationUrl: &amp;quot;http://localhost:8888/oauth2/code&amp;quot;
    flow: &amp;quot;implicit&amp;quot;
    scopes:
      oauth.user.w: &amp;quot;write user&amp;quot;
      oauth.user.r: &amp;quot;read user&amp;quot;
definitions:
  User:
    type: &amp;quot;object&amp;quot;
    required:
    - &amp;quot;userId&amp;quot;
    - &amp;quot;userType&amp;quot;
    - &amp;quot;firstName&amp;quot;
    - &amp;quot;lastName&amp;quot;
    - &amp;quot;email&amp;quot;
    properties:
      userId:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;a unique id&amp;quot;
      userType:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;user type&amp;quot;
        enum:
        - &amp;quot;admin&amp;quot;
        - &amp;quot;employee&amp;quot;
        - &amp;quot;customer&amp;quot;
        - &amp;quot;partner&amp;quot;
      firstName:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;first name&amp;quot;
      lastName:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;last name&amp;quot;
      email:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;email address&amp;quot;
      password:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;password&amp;quot;
        description: &amp;quot;password&amp;quot;
      passwordConfirm:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;password&amp;quot;
        description: &amp;quot;password confirm&amp;quot;
      createDt:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;date-time&amp;quot;
        description: &amp;quot;create date time&amp;quot;
      updateDt:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;date-time&amp;quot;
        description: &amp;quot;update date time&amp;quot;
  Password:
    type: &amp;quot;object&amp;quot;
    required:
    - &amp;quot;password&amp;quot;
    - &amp;quot;newPassword&amp;quot;
    - &amp;quot;newPasswordConfirm&amp;quot;
    properties:
      password:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;password&amp;quot;
        description: &amp;quot;existing password&amp;quot;
      newPassword:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;password&amp;quot;
        description: &amp;quot;new password&amp;quot;
      newPasswordConfirm:
        type: &amp;quot;string&amp;quot;
        format: &amp;quot;password&amp;quot;
        description: &amp;quot;new password confirm&amp;quot;

&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-password-userid-post&#34;&gt;/oauth2/password/{userId}@post&lt;/h2&gt;

&lt;p&gt;This endpoint is used to reset user password. The user has to provide existing password,
the new password and password confirmation in order to reset it.&lt;/p&gt;

&lt;p&gt;There are several validations need to be performed before the password can be reset.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If userId cannot be found in the user cache, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12013&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12013&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;USER_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;User %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If password is not matched the cached password, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12016&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 401,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12016&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;INCORRECT_PASSWORD&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Incorrect password.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If new password and password confirmation are not matched, then the following error
will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12012&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12012&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;PASSWORD_PASSWORDCONFIRM_NOT_MATCH&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Password %s and PasswordConfirm %s are not matched.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-user-get&#34;&gt;/oauth2/user@get&lt;/h2&gt;

&lt;p&gt;This endpoint gets all the users from user service with filter and sorted on
userId. A page query parameter is mandatory. pageSize and userId filter
are optional.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;page&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Page number which must be specified. It starts with 1 and an empty list will
be returned if the page is greater than the last page.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;pageSize&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Default pageSize is 10 and you can overwrite it with another number. Please don&amp;rsquo;t
use a big number due to performance reason.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;userId&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is the only filter available and it supports filter by start with a few characters.
For example, &amp;ldquo;userId=abc&amp;rdquo; means any userId starts with &amp;ldquo;abc&amp;rdquo;. The result is also
sorted by userId in the pagination.&lt;/p&gt;

&lt;p&gt;The following validation will be performed in the service.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If page is missing from the query parameter, an error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11000&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11000&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_REQUEST_PARAMETER_QUERY_MISSING&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Query parameter &#39;%s&#39; is required on path &#39;%s&#39; but not found in request.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-user-post&#34;&gt;/oauth2/user@post&lt;/h2&gt;

&lt;p&gt;This endpoint is used to create a new user. The following validations will be performed
before a new user will be added.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If the userId exists in the system, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12020&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12020&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;USER_ID_EXISTS&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;User id %s exists.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If the email exists in the system, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12021&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12021&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;EMAIL_EXISTS&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Email %s exists.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If new password and password confirmation are not matched, the following error
will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12012&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12012&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;PASSWORD_PASSWORDCONFIRM_NOT_MATCH&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Password %s and PasswordConfirm %s are not matched.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If password or password confirmation is empty, the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12011&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12011&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;PASSWORD_OR_PASSWORDCONFIRM_EMPTY&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Password %s or PasswordConfirm %s is empty.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-user-put&#34;&gt;/oauth2/user@put&lt;/h2&gt;

&lt;p&gt;This is the endpoint to update existing user. Most of the attributes of users can be
updated through this endpoint except password. You must use password reset endpoint
to update password.&lt;/p&gt;

&lt;p&gt;The following validations will be performed before the user will be updated.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If userId cannot be found in cache, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12013&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12013&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;USER_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;User %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-user-userid-delete&#34;&gt;/oauth2/user/{userId}@delete&lt;/h2&gt;

&lt;p&gt;This endpoint is used to delete an existing user. It removes the user physically so
be careful when calling this endpoint. On the user interface, please make sure the
operator confirms the action before submitting the request to the service.&lt;/p&gt;

&lt;p&gt;Before the user is deleted, the following validation will be performed.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If userId doesn&amp;rsquo;t exist in memory, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12013&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12013&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;USER_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;User %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-user-userid-get&#34;&gt;/oauth2/user/{userId}get&lt;/h2&gt;

&lt;p&gt;This is the endpoint to get a particular user with userId. The server will perform
the following validations before the user object is returned to the consumer.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If userId doesn&amp;rsquo;t exist in cache, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12013&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12013&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;USER_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;User %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;key&#34;&gt;Key&lt;/h1&gt;

&lt;p&gt;In microservices architecture, the traditional way of copying public key certificates
to hosts of services is not working. With container orchestration tool like Kubernetes
old containers can be shutdown and new container can be started at anytime. So the push
certificates to services has to be changed to pull certificates from OAuth2 server
instead. This service is designed to pull public key certificate based on keyId that is
in the JWT token header. It is tighly integrated with Light-Java framework security
component.&lt;/p&gt;

&lt;p&gt;This service is listening to port number 6886.&lt;/p&gt;

&lt;p&gt;Here is the specification&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;swagger: &#39;2.0&#39;

info:
  version: &amp;quot;1.0.0&amp;quot;
  title: OAuth2 Key Service
  description: OAuth2 Key Service microservices endpoints. 
  contact:
    email: stevehu@gmail.com
  license:
    name: &amp;quot;Apache 2.0&amp;quot;
    url: &amp;quot;http://www.apache.org/licenses/LICENSE-2.0.html&amp;quot;
host: oauth2.networknt.com
schemes:
  - http
  - https

consumes:
  - application/json
produces:
  - application/json

paths:
  /oauth2/key/{keyId}:
    get:
      description: Get a key by Id
      operationId: getKeyById
      parameters:
      - name: &amp;quot;keyId&amp;quot;
        in: &amp;quot;path&amp;quot;
        description: &amp;quot;Key Id&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      responses:
        200: 
          description: Successful response
          schema:
            $ref: &amp;quot;#/definitions/Key&amp;quot;          
        400:
          description: &amp;quot;Invalid keyId supplied&amp;quot;
        404:
          description: &amp;quot;Key not found&amp;quot;
      security:
        - key_auth:
          - oauth.key.r
          - oauth.key.w

securityDefinitions:
  key_auth:
    type: &amp;quot;oauth2&amp;quot;
    authorizationUrl: &amp;quot;http://localhost:8888/oauth2/code&amp;quot;
    flow: &amp;quot;implicit&amp;quot;
    scopes:
      oauth.key.w: &amp;quot;write key&amp;quot;
      oauth.key.r: &amp;quot;read key&amp;quot;
definitions:
  Key:
    type: &amp;quot;object&amp;quot;
    required:
    - &amp;quot;keyId&amp;quot;
    - &amp;quot;certificate&amp;quot;
    properties:
      keyId:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;a unique id&amp;quot;
      certificate:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;certificate&amp;quot;

&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;oauth2-key-keyid-get&#34;&gt;/oauth2/key/{keyId}@get&lt;/h2&gt;

&lt;p&gt;This endpoint is used to get public key certificate for JWT signature verification based
on keyId in the JWT header. Light-Java framework should have packaged with several keys
already when deployed to production, however, keys are changing frequently as old ones
are expired. You don&amp;rsquo;t want to redeploy your services just due to key changes on the
OAuth server. This endpoint is available for all services which have an entry in client
table so that clientId and clientSecret can be used to verify the identity of the service.&lt;/p&gt;

&lt;p&gt;The following validations are performed before the key is issued by the service.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If authorization header doesn&amp;rsquo;t exist in the request, the following error will be
returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12002&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 401,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12002&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;MISSING_AUTHORIZATION_HEADER&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Missing authorization header. client credentials must be passed in as Authorization header.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If the client secret is not correct when matching with hashed and salted client secret
in cache, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12007&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 401,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12007&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;UNAUTHORIZED_CLIENT&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Unauthorized client with wrong client secret.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If the client id in the authorization header doesn&amp;rsquo;t exist in client cache in memory,
then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12014&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12014&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;CLIENT_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Client %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;If the keyId cannot be found on the server, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR10010&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 500,
    &amp;quot;code&amp;quot;: &amp;quot;ERR10010&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;RUNTIME_EXCEPTION&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Unexpected runtime exception&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;refresh-token&#34;&gt;Refresh Token&lt;/h1&gt;

&lt;p&gt;Refresh Token is issued in Authorization Code Grant and Resource Owner Password Credentials
Grant along with access token. Also, for maximum security, a refresh token is issued every
time the old refresh token is used to renew an access token.&lt;/p&gt;

&lt;p&gt;This service is listening to port number 6886.&lt;/p&gt;

&lt;p&gt;Here is the specification&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;swagger: &#39;2.0&#39;

info:
  version: &amp;quot;1.0.0&amp;quot;
  title: OAuth2 Refresh Token Management
  description: OAuth2 refresh token management microservices endpoints. 
  contact:
    email: stevehu@gmail.com
  license:
    name: &amp;quot;Apache 2.0&amp;quot;
    url: &amp;quot;http://www.apache.org/licenses/LICENSE-2.0.html&amp;quot;
host: oauth2.networknt.com
schemes:
  - http
  - https

consumes:
  - application/json
produces:
  - application/json

paths:
  /oauth2/refresh_token:
    get:
      description: Return all refresh tokens
      operationId: getAllRefreshToken
      parameters:
      - name: &amp;quot;page&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Page number&amp;quot;
        required: true
        type: &amp;quot;integer&amp;quot;
        format: &amp;quot;int32&amp;quot;
      - name: &amp;quot;pageSize&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Pag size&amp;quot;
        required: false
        type: &amp;quot;integer&amp;quot;
        format: &amp;quot;int32&amp;quot;
      - name: &amp;quot;userId&amp;quot;
        in: &amp;quot;query&amp;quot;
        description: &amp;quot;Partial userId for filter&amp;quot;
        required: false
        type: &amp;quot;string&amp;quot;
      responses:
        200:
          description: &amp;quot;successful operation&amp;quot;
          schema:
            type: &amp;quot;array&amp;quot;
            items:
              $ref: &amp;quot;#/definitions/RefreshToken&amp;quot;
      security:
      - refresh_token_auth:
        - &amp;quot;oauth.refresh_token.r&amp;quot;
          
  /oauth2/refresh_token/{refreshToken}:
    delete:
      description: Delete a refresh token
      operationId: deleteRefreshToken
      parameters:
      - name: &amp;quot;refreshToken&amp;quot;
        in: &amp;quot;path&amp;quot;
        description: &amp;quot;Refresh Token&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      responses:
        400:
          description: &amp;quot;Invalid refresh token supplied&amp;quot;
        404:
          description: &amp;quot;Refresh token not found&amp;quot;
      security:
        - refresh_token_auth:
          - oauth.refresh_token.w
    get:
      description: Get a refresh token
      operationId: getRefreshToken
      parameters:
      - name: &amp;quot;refreshToken&amp;quot;
        in: &amp;quot;path&amp;quot;
        description: &amp;quot;Refresh token&amp;quot;
        required: true
        type: &amp;quot;string&amp;quot;
      responses:
        200: 
          description: Successful response
          schema:
            $ref: &amp;quot;#/definitions/RefreshToken&amp;quot;          
        400:
          description: &amp;quot;Invalid refresh token supplied&amp;quot;
        404:
          description: &amp;quot;Refresh token not found&amp;quot;
      security:
        - refresh_token_auth:
          - oauth.refresh_token.r
          - oauth.refresh_token.w

securityDefinitions:
  refresh_token_auth:
    type: &amp;quot;oauth2&amp;quot;
    authorizationUrl: &amp;quot;http://localhost:8888/oauth2/code&amp;quot;
    flow: &amp;quot;implicit&amp;quot;
    scopes:
      oauth.refresh_token.w: &amp;quot;write oauth refresh token&amp;quot;
      oauth.refresh_token.r: &amp;quot;read oauth refresh token&amp;quot;
definitions:
  RefreshToken:
    type: &amp;quot;object&amp;quot;
    required:
    - &amp;quot;refreshToken&amp;quot;
    - &amp;quot;userId&amp;quot;
    - &amp;quot;clientId&amp;quot;
    properties:
      refreshToken:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;refresh token&amp;quot;
      userId:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;user id&amp;quot;
      clientId:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;client id&amp;quot;
      scope:
        type: &amp;quot;string&amp;quot;
        description: &amp;quot;service scopes separated by space&amp;quot;

&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;implementation-2&#34;&gt;Implementation&lt;/h2&gt;

&lt;h3 id=&#34;oauth2-refresh-token-get&#34;&gt;/oauth2/refresh_token@get&lt;/h3&gt;

&lt;p&gt;This endpoint gets all the issued refresh tokens with filter and sorted on
userId. A page query parameter is mandatory. pageSize and userId filter
are optional.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;page&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Page number which must be specified. It starts with 1 and an empty list will
be returned if the page is greater than the last page.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;pageSize&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Default pageSize is 10 and you can overwrite it with another number. Please don&amp;rsquo;t
use a big number due to performance reason.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;userId&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is the only filter available and it supports filter by start with a few characters.
For example, &amp;ldquo;userId=abc&amp;rdquo; means any userId starts with &amp;ldquo;abc&amp;rdquo;. The result is also
sorted by userId in the pagination.&lt;/p&gt;

&lt;p&gt;The following validation will be performed in the service.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If page is missing from the query parameter, an error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR11000&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 400,
    &amp;quot;code&amp;quot;: &amp;quot;ERR11000&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;VALIDATOR_REQUEST_PARAMETER_QUERY_MISSING&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Query parameter &#39;%s&#39; is required on path &#39;%s&#39; but not found in request.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;oauth2-refresh-token-refreshtoken-delete&#34;&gt;/oauth2/refresh_token/{refreshToken}@delete&lt;/h3&gt;

&lt;p&gt;This endpoint is used to revoke a refresh token. It removes the refresh token from
in memory data grid when calling this endpoint. On the user interface, please make
sure the operator confirms the action before submitting the request to the service.&lt;/p&gt;

&lt;p&gt;Before the refresh token is deleted, the following validation will be performed.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If refresh token doesn&amp;rsquo;t exist in memory, then the following error will be
returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12029&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12029&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;REFRESH_TOKEN_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Refresh token %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;oauth2-refresh-token-refreshtoken&#34;&gt;/oauth2/refresh_token/{refreshToken}&lt;/h3&gt;

&lt;p&gt;This is the endpoint to get a particular refresh token information. The server
will perform the following validations before the refresh token object is returned
to the consumer.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If refresh token doesn&amp;rsquo;t exist in cache, then the following error will be returned.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;  &amp;quot;ERR12029&amp;quot;: {
    &amp;quot;statusCode&amp;quot;: 404,
    &amp;quot;code&amp;quot;: &amp;quot;ERR12029&amp;quot;,
    &amp;quot;message&amp;quot;: &amp;quot;REFRESH_TOKEN_NOT_FOUND&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Refresh token %s is not found.&amp;quot;
  }
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Development Edition</title>
      <link>https://networknt.github.io/light-oauth2/services/development/</link>
      <pubDate>Sun, 01 Jan 2017 09:28:06 -0500</pubDate>
      
      <guid>https://networknt.github.io/light-oauth2/services/development/</guid>
      <description></description>
    </item>
    
  </channel>
</rss>